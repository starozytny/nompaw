{% extends 'user/pages/randos/template.html.twig' %}

{% set author = elem.author %}

{% block title %}{{ elem.name }} | {{ page_prefix }}{% endblock %}
{% set page_title_alone %}{{ elem.name }}{% endset %}
{% set page_subtitle %}Groupe de randonnée : {{ elem.name }}{% endset %}

{% block breadcrumb %}
    {% set breadcrumbs = breadcrumbs | merge([
        { text: page_title_alone, url: path('user_randos_groupes_read', {'slug': elem.slug})  },
    ]) %}
    {{ parent() }}
{% endblock %}

{% set half_width = true %}

{% block main_content %}
    <div class="page-actions">
        <div class="col-1">
            <a href="{{ path('user_randos_groupes_index') }}" class="btn btn-outline-default">
                <span class="icon-left-arrow"></span>
                <span>Retourner aux groupes</span>
            </a>
        </div>
        <div class="col-2">
            {% if app.user.id == elem.author.id %}
                <a href="{{ path('user_randos_groupes_update', {'slug': elem.slug}) }}" class="btn btn-warning">
                    <span class="icon-pencil"></span>
                    <span>Modifier</span>
                </a>
                <div class="delete-groupe"
                     data-context="read"
                     data-id="{{ elem.id }}"
                     data-name="{{ elem.name }}"
                >
                    <button class="btn btn-danger btn-loader-without-text">
                        <span class="icon-chart-3"></span>
                        <span>Supprimer</span>
                    </button>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="page-default">
        <div class="groupe-read">
            <div class="groupe-line-0">
                <div class="next-rando">
                    {% if next %}
                        <div class="col-1">
                            <div>
                                <h2>{{ next.name }}</h2>
                                <div class="subtitle">Prochaine randonnée !</div>
                                <div class="subtitle sub-icon" style="margin-top: 4px;">
                                    <span class="icon-calendar"></span>
                                    <span>{{ next.startAt ? next.startAt | date('D, d M Y') : 'Date indéfinie' }}</span>
                                </div>
                            </div>
                            <div class="actions">
                                <a href="{{ path('user_randos_rando_update', {'slug': elem.slug}) }}" class="btn-icon btn-icon-warning">
                                    <span class="icon-pencil"></span>
                                    <span class="tooltip">Modifier</span>
                                </a>

                                <div class="delete-rando"
                                     data-context="randos"
                                     data-id="{{ next.id }}"
                                     data-name="{{ next.name }}"
                                     data-groupe-slug="{{ elem.slug }}"
                                >
                                    <button class="btn-icon btn-icon-danger btn-loader-without-text"><span class="icon-chart-3"></span></button>
                                </div>
                            </div>
                        </div>

                        <div class="col-2">
                            <div class="steps">
                                <div class="ra-status {{- next.status == 0 ? ' active' : ''  -}}">
                                    <span>en proposition</span>
                                </div>
                                <div class="ra-status {{- next.status == 1 ? ' active' : '' -}}">
                                    <span>validée</span>
                                </div>
                                <div class="ra-status {{- next.status == 2 ? ' active' : '' -}}">
                                    <span>terminée</span>
                                </div>
                            </div>

                            <div class="cta">
                                <a href="{{ path('user_randos_rando_read', {'slug': next.slug}) }}" class="btn btn-primary">
                                    <span>Voir la rando</span>
                                    <span class="icon-right-arrow"></span>
                                </a>
                            </div>
                        </div>
                    {% else %}
                        <div class="col-1">
                            <div>
                                <h2>Aucune randonnée de prévu.</h2>
                                <div class="subtitle">Préparer la prochaine randonnée en cliquant sur <i>Créer une randonnée</i></div>
                            </div>
                        </div>

                        <div class="col-2">
                            <img src="{{ asset(elem.imageFile) }}" alt="logo {{ elem.name }}">
                            <div class="cta">
                                <a href="{{ path('user_randos_rando_create', {'g_slug': elem.slug}) }}" class="btn btn-primary">
                                    <span class="icon-add"></span>
                                    <span>Créer une rando</span>
                                </a>
                            </div>
                        </div>
                    {% endif %}
                </div>
                <div class="next-creator">
                    <h2><span class="icon-user-octagon" style="font-size: 24px;"></span> {{ elem.author.displayName }}</h2>
                    <div class="subtitle">Référent.e du groupe de randonnée</div>
                    {% if next %}
                        <h2 style="margin-top: 12px;"><span class="icon-user-octagon" style="font-size: 24px;"></span> {{ next.author.displayName }}</h2>
                        <div class="subtitle">Référent.e de la prochaine randonnée</div>
                    {% endif %}
                </div>
            </div>

            <div class="groupe-line-1">
                <div class="groupe-line-title">
                    <h2>Anciennes randonnées</h2>
                    <div class="subtitle">En dev.</div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
